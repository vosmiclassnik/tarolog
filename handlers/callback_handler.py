import telebot
from telebot import types
from telebot.types import LabeledPrice
import telegram
from utils.logger import setup_logger

logger = setup_logger()



def register_callback(bot):
    @bot.callback_query_handler(func=lambda call: True)
    def call(c):
            parse = telegram.constants.ParseMode.HTML
            if c.data == 'rasklad':
                text = 'üé¥ <b>–†–∞—Å–∫–ª–∞–¥ –Ω–∞ –¢–∞—Ä–æ</b> ‚Äî —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –∏–º–µ–Ω–Ω–æ –Ω–∞ —Ç–≤–æ–π –≤–æ–ø—Ä–æ—Å –∏–ª–∏ —Å–∏—Ç—É–∞—Ü–∏—é.\n–ù–µ –ø—Ä–æ—Å—Ç–æ –æ–±—â–∏–µ —Å–ª–æ–≤–∞, –∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –ø–æ–Ω—è—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ –∏ –≤–æ–∫—Ä—É–≥, —É–≤–∏–¥–µ—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –¥–µ—Ç–∞–ª–∏ –∏ —Å–¥–µ–ª–∞—Ç—å –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä.\n\nüí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥–∏ ‚Äî 100 —Ä—É–±–ª–µ–π –∑–∞ –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å.\n–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —è –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Å–¥–µ–ª–∞—é —Ä–∞—Å–∫–ª–∞–¥ –∏ –æ–±—ä—è—Å–Ω—é –∫–∞–∂–¥—É—é –∫–∞—Ä—Ç—É ‚Äî —Ç—ã —É–∑–Ω–∞–µ—à—å —Ç–æ, —á—Ç–æ –≤–∞–∂–Ω–æ –∏–º–µ–Ω–Ω–æ —Ç–µ–±–µ.\n\n–¢—ã —Å–º–æ–∂–µ—à—å –∑–∞–¥–∞—Ç—å –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å: –ø—Ä–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, —Ä–∞–±–æ—Ç—É, –ª–∏—á–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –∏–ª–∏ –ª—é–±—É—é —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–ª–Ω—É–µ—Ç.\n–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–≥—É –ø–æ–º–æ—á—å —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å, —á—Ç–æ–±—ã —Ä–∞—Å–∫–ª–∞–¥ –±—ã–ª –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–ª–µ–∑–Ω—ã–º.\n\nüåø –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞, –º—ã—Å–ª–∏ –∏ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ ‚Äî –≤ –∫–∞–Ω–∞–ª–µ @rattarot89\nüì© –ì–æ—Ç–æ–≤(–∞) ‚Äî –ø–∏—à–∏ –∏ –¥–æ–≥–æ–≤–æ—Ä–∏–º—Å—è –æ –¥–µ—Ç–∞–ª—è—Ö: @rattarolog'
                bot.send_message(c.message.chat.id, text, parse_mode=parse)
            if c.data == 'traktovka':
                text = 'üîç <b>–¢—Ä–∞–∫—Ç–æ–≤–∫–∞ –∫–∞—Ä—Ç</b> ‚Äî –µ—Å–ª–∏ —Ç—ã —Å–∞–º(–∞) —É–∂–µ –≤—ã—Ç—è–Ω—É–ª(–∞) –∫–∞—Ä—Ç—ã, –Ω–æ –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ –ø–æ–Ω–∏–º–∞–µ—à—å, —á—Ç–æ –æ–Ω–∏ —Ö–æ—Ç—è—Ç —Å–∫–∞–∑–∞—Ç—å.\n–Ø –ø–æ–º–æ–≥—É —Ç–µ–±–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å –∫–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª –∏ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å, –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è –∏–º–µ–Ω–Ω–æ –∫ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏.\n\nüí° –≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–π, –∞ –∂–∏–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Å–∞–π—Ç—ã –∏ –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å –∫–∞—Ä—Ç—ã.\n\nüí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å ‚Äî 150 —Ä—É–±–ª–µ–π –∑–∞ —Ç—Ä–∞–∫—Ç–æ–≤–∫—É –æ–¥–Ω–æ–≥–æ —Ä–∞—Å–∫–ª–∞–¥–∞.\n\n–ï—Å–ª–∏ –µ—Å—Ç—å —Å–≤–æ–∏ –∫–∞—Ä—Ç—ã –∏ –≤–æ–ø—Ä–æ—Å—ã ‚Äî –ø–∏—à–∏, —Ä–∞—Å—Å–∫–∞–∂—É, –∫–∞–∫ —ç—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.\n\nüåø –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞, –º—ã—Å–ª–∏ –∏ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ ‚Äî –≤ –∫–∞–Ω–∞–ª–µ @rattarot89\nüì© –î–ª—è —Å–≤—è–∑–∏ –∏ –∑–∞–∫–∞–∑–∞: @rattarolog'
                bot.send_message(c.message.chat.id, text, parse_mode=parse)
            if c.data == 'razbor':
                text = 'üß¨ <b>–†–∞–∑–±–æ—Ä –º–∞—Ç—Ä–∏—Ü—ã —Å—É–¥—å–±—ã</b> ‚Äî –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –ø–æ–Ω—è—Ç—å —Å–µ–±—è –≥–ª—É–±–∂–µ.\n–≠—Ç–æ –ø—Ä–æ —Ç–≤–æ–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: —Ö–∞—Ä–∞–∫—Ç–µ—Ä, —Å–∏–ª—å–Ω—ã–µ –∏ —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã, –∫–∞—Ä–º–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏, —Ç–∞–ª–∞–Ω—Ç—ã, –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –ª—é–¥—å–º–∏ –∏ —Å–æ–±–æ–π.\n\n–ú–∞—Ç—Ä–∏—Ü–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è ‚Äî –∏ —á–∞—Å—Ç–æ –¥–∞—ë—Ç –æ—á–µ–Ω—å —Ç–æ—á–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã:\n–ø–æ—á–µ–º—É –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è, –≥–¥–µ —Ç–≤–æ—è —Å–∏–ª–∞, –∞ –≥–¥–µ ‚Äî —Ç–æ—á–∫–∞ —Ä–æ—Å—Ç–∞.\n\nüí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–±–æ—Ä–∞ ‚Äî 350 —Ä—É–±–ª–µ–π.\n–í –æ—Ç–≤–µ—Ç —Ç—ã –ø–æ–ª—É—á–∏—à—å –≥–æ–ª–æ—Å–æ–≤–æ–µ –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –∏ –æ–ø–æ—Ä–æ–π –∏–º–µ–Ω–Ω–æ –Ω–∞ —Ç–≤–æ—é –¥–∞—Ç—É.\n\nüåø –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞, –º—ã—Å–ª–∏ –∏ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ ‚Äî –≤ –∫–∞–Ω–∞–ª–µ @rattarot89\nüì© –•–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å, —á—Ç–æ –≤ —Ç–≤–æ–µ–π –º–∞—Ç—Ä–∏—Ü–µ? –ü–∏—à–∏: @rattarolog'
                bot.send_message(c.message.chat.id, text, parse_mode=parse)
            if c.data == 'guides':
                text = 'üìö <b>–ì–∞–π–¥—ã, —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞—à–∏–º–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏</b> ‚Äî –µ—Å–ª–∏ —Ö–æ—á–µ—à—å —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —Ç–µ–º–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –Ω–æ –±–µ–∑ –≤–æ–¥—ã –∏ —Ö–∞–æ—Å–∞ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.\n\n–†–∞–∑–æ–≤—ã–µ, –ø–æ –¥–µ–ª—É. –£–¥–æ–±–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è.\n\n–ß—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≥–∞–π–¥—ã, –Ω–∞–ø–∏—à–∏ –∫–æ–º–∞–Ω–¥—É:\n/guide'
                bot.send_message(c.message.chat.id, text, parse_mode=parse)
            if c.data == 'matriza':
                try:
                    amount = 650
                    title = "üß¨–ú–ê–¢–†–ò–¶–êüß¨"
                    url = bot.create_invoice_link(
                            title=title,
                            description="üß¨–ú–ê–¢–†–ò–¶–êüß¨ - –õ—É—á—à–∏–π –≥–∞–π–¥ –ø–æ —Ä–∞–∑–±–æ—Ä—É –º–∞—Ç—Ä–∏—Ü—ã",
                            currency="XTR",
                            prices=[LabeledPrice(label="XTR", amount=amount)],
                            payload="MATRIZA",
                            provider_token=None
                        )
                    markup = types.InlineKeyboardMarkup()
                    button = types.InlineKeyboardButton("–ö–£–ü–ò–¢–¨ –ì–ê–ô–î üß¨–ú–ê–¢–†–ò–¶–êüß¨", url=url)
                    markup.add(button)
                    text = 'üß¨ <b>–ö–∞–∫ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—É —Å—É–¥—å–±—ã —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ</b>\n–≠—Ç–æ—Ç –≥–∞–π–¥ ‚Äî –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∫—Ä–∞—Å–∏–≤—ã–µ —Å—Ö–µ–º—ã, <b>–∞ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ —Å–µ–±–µ –∏ –ª—é–¥—è—Ö —á–µ—Ä–µ–∑ –º–∞—Ç—Ä–∏—Ü—É.</b>\n–¢—ã —É–∑–Ω–∞–µ—à—å, —á—Ç–æ –∑–Ω–∞—á–∞—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏, –∫–∞–∫ —Å—á–∏—Ç—ã–≤–∞—Ç—å —Å–º—ã—Å–ª –∑–∞ —Ü–∏—Ñ—Ä–∞–º–∏, –∏ —á—Ç–æ —Å —ç—Ç–∏–º –¥–µ–ª–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏.\n–ü–æ–¥–æ–π–¥—ë—Ç –∏ –Ω–æ–≤–∏—á–∫–∞–º, –∏ —Ç–µ–º, –∫—Ç–æ —É–∂–µ –¥–µ–ª–∞–ª —Ä–∞–∑–±–æ—Ä—ã, –∏ –∫–∞–∫ –±–∞–∑–∞, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –Ω–∞—á–∞—Ç—å –ø–æ–º–æ–≥–∞—Ç—å –¥—Ä—É–≥–∏–º –∏ <b>–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ —Ä–∞–∑–±–æ—Ä–µ –∫–æ–¥–æ–≤</b>'
                    bot.send_message(c.message.chat.id, text, reply_markup=markup, parse_mode=parse)
                    logger.info(f'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {c.message.chat.id} –≤—ã–±—Ä–∞–ª –∫—É—Ä—Å –ú–ê–¢–†–ò–¶–ê')
                except Exception as e:
                    text = '‚ùóÔ∏è–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.\n–ò–Ω–æ–≥–¥–∞ —Ç–µ—Ö–Ω–∏–∫–∞ —á—É–¥–∏—Ç ‚Äî –¥–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º –µ—â—ë —Ä–∞–∑ —á—É—Ç—å –ø–æ–∑–∂–µ.\n\n–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –∏–ª–∏ —Å–æ–≤—Å–µ–º –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç ‚Äî –Ω–∞–ø–∏—à–∏ –º–Ω–µ, —Ä–∞–∑–±–µ—Ä—ë–º—Å—è: @lillbreathyy\n\n–°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–µ—Ä–ø–µ–Ω–∏–µ üí´'
                    logger.error(f'–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {c.message.chat.id} –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Å—ã–ª–∫–∏ –æ–ø–ª–∞—Ç—ã –∫—É—Ä—Å–∞ –ú–ê–¢–†–ò–¶–ê: {e}', exc_info=True)
                    bot.send_message(c.message.chat.id, text)
            if c.data == 'finkod':
                try:
                    amount = 450
                    title = 'üí∏–§–ò–ù–ê–ù–°–û–í–´–ô –ö–û–îüí∏'
                    url = bot.create_invoice_link(
                        title=title,
                        description="üí∏–§–ò–ù–ê–ù–°–û–í–´–ô –ö–û–îüí∏ - –õ—É—á—à–∏–π –≥–∞–π–¥ –ø–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–º—É –∫–æ–¥—É",
                        currency="XTR",
                        prices=[LabeledPrice(label="XTR", amount=amount)],
                        payload="FINKOD",
                        provider_token=None
                    )
                    markup = types.InlineKeyboardMarkup()
                    button = types.InlineKeyboardButton("–ö–£–ü–ò–¢–¨ –ì–ê–ô–î üí∏–§–ò–ù–ê–ù–°–û–í–´–ô –ö–û–îüí∏", url=url)
                    markup.add(button)
                    text = 'üí∏ <b>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–¥</b>\n–ì–∞–π–¥ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –ø–æ–Ω—è—Ç—å, <b>–ø–æ—á–µ–º—É —Å –¥–µ–Ω—å–≥–∞–º–∏ –Ω–µ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è</b> ‚Äî –∏ –∫–∞–∫ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–≤–æ–∏–º–∏ —á–∏—Å–ª–∞–º–∏ –ø–æ –¥–∞—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏—è.\n–†–∞—Å—Å–∫–∞–∂—É, <b>–∫–∞–∫–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ —Ñ–∏–Ω–∞–Ω—Å—ã</b>, –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç ¬´–∑–∞–≤–∏—Å–∞—Ç—å¬ª –∏ —á—Ç–æ —Å —ç—Ç–∏–º –¥–µ–ª–∞—Ç—å.'
                    bot.send_message(c.message.chat.id, text, reply_markup=markup, parse_mode=parse)
                    logger.info(f'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {c.message.chat.id} –≤—ã–±—Ä–∞–ª –∫—É—Ä—Å –§–ò–ù–ö–û–î')
                except Exception as e:
                    text = '‚ùóÔ∏è–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.\n–ò–Ω–æ–≥–¥–∞ —Ç–µ—Ö–Ω–∏–∫–∞ —á—É–¥–∏—Ç ‚Äî –¥–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º –µ—â—ë —Ä–∞–∑ —á—É—Ç—å –ø–æ–∑–∂–µ.\n\n–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –∏–ª–∏ —Å–æ–≤—Å–µ–º –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç ‚Äî –Ω–∞–ø–∏—à–∏ –º–Ω–µ, —Ä–∞–∑–±–µ—Ä—ë–º—Å—è: @lillbreathyy\n\n–°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–µ—Ä–ø–µ–Ω–∏–µ üí´'
                    logger.error(
                        f'–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {c.message.chat.id} –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Å—ã–ª–∫–∏ –æ–ø–ª–∞—Ç—ã –∫—É—Ä—Å–∞ –§–ò–ù–ö–û–î: {e}',
                        exc_info=True)
                    bot.send_message(c.message.chat.id, text)
